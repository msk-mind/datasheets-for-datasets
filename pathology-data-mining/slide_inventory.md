# Slide Inventory

<b>Path:</b> `cdsi_prod.pathology-data-mining.slide_inventory` <br/>
<b>Table Type:</b> Live <br/>
<b>Date last updated:</b> `2025-12-08` <br/>

<b>Lineage:</b>

Storage systems (S3, ECS, on-prem) <br/>
|_ `cdsi_prod.pathology-data-mining.slide_inventory` <br/>

<b>Summary Statistics:</b>

Total number of rows: 808490 <br/>
Total number of unique images: 790964 <br/>


# Table of contents
1. [Description](#description)
2. [Vocabulary](#vocab)
3. [Notes](#notes)

## Description <a name="description"></a>

This dataset provides an inventory of whole slide images (WSI) stored across multiple storage platforms used by the Pathology Data Mining (PDM) team. The table tracks the location, size, and last modification date of digitized pathology slides to facilitate data management and access across distributed storage systems.

### Motivation

The PDM team stores digitized pathology slides across multiple storage platforms (Amazon S3, ECS, and on-premise storage). This inventory table provides a centralized catalog of all slides and their storage locations, enabling efficient data discovery, storage management, and access planning for computational pathology workflows.

### Composition

Each row represents a single whole slide image file with its storage metadata. The dataset combines information from multiple storage backends to provide a unified view of available slide data.

### Collection Process

The inventory is generated by scanning the PDM team's storage systems (S3 buckets, ECS storage, and on-premise file systems) and collecting metadata about each slide file. The table is updated regularly to reflect new slide acquisitions and storage migrations.

### Expected Uses

- Locating slides for computational pathology analyses
- Storage capacity planning and optimization
- Tracking slide data migrations between storage platforms
- Identifying duplicate or missing slide files

## Vocabulary <a name="vocab"></a>

Primary key: `image_id`

| **Field name** | **Description** | **Field Type** | **Data Type** | **Field Format** |
|---|---|---|---|---|
| image_id | Unique identifier for the whole slide image | ID | string | - |
| source | Storage platform where the image file is located | Categorical | string | "AWS" - Amazon S3 storage<br/>"ECS" - ECS storage system<br/>"On-prem Storage" - On-premise storage |
| path | Full path to the image file, including protocol prefix for cloud storage | Path/URL | string | For S3: "s3://bucket-name/path/to/file"<br/>For on-prem: "/full/path/to/file" |
| size | Size of the image file in bytes | File Size | integer | Integer value representing bytes |
| last_modified | Timestamp when the file was last modified | Date | string | ISO 8601 format with timezone offset<br/>Example: "2025-06-30T18:26:37.978+00:00" |

## Notes <a name="notes"></a>

### Data Quality

- **image_id uniqueness**: Each `image_id` should be unique across the entire inventory. Verify with:
  ```sql
  SELECT image_id, count(image_id) as ct
  FROM cdsi_prod.pathology-data-mining.slide_inventory
  GROUP BY image_id
  ORDER BY ct DESC
  -- All counts should be 1
  ```

- **source values**: The `source` field should only contain the values "AWS", "ECS", or "On-prem Storage". Any other values indicate data quality issues.

- **path consistency**:
  - Paths for S3 sources should start with "s3://"
  - Paths should be valid and accessible from the storage system indicated by `source`

- **size values**: The `size` field should always be a positive integer. Zero or null values may indicate incomplete file uploads or metadata collection errors.

- **last_modified format**: Timestamps are in ISO 8601 format with timezone offset. All timestamps should parse correctly as datetime values.

### Storage Distribution

- Slides may be stored on multiple platforms for redundancy or migration purposes
- The same slide content may appear with different `image_id` values if stored in multiple locations
- S3 storage typically used for long-term archival and cloud-based processing
- On-premise storage used for high-performance local processing

### Maintenance

- This table is updated regularly as new slides are added to storage systems
- `last_modified` dates reflect when files were written or updated, not when slides were originally scanned
- TODO: make a list of type of slide buckets we have, like reef-slides etc. and describe the motivation for each
